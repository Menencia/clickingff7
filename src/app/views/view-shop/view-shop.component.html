<app-ui-layout-default>
  <div class="grid grid-cols-5 gap-x-4">
    <div>
      <div class="flex flex-col gap-1">
        <app-button
          [class]="{ current: type === 'weapons' }"
          (trigger)="changeType('weapons')"
        >
          {{ "Weapons" | translate }}
        </app-button>
        <app-button
          [class]="{ current: type === 'materias' }"
          (trigger)="changeType('materias')"
        >
          {{ "Materia" | translate }}
        </app-button>
        <app-button
          [class]="{ current: type === 'items' }"
          (trigger)="changeType('items')"
        >
          {{ "Items" | translate }}
        </app-button>
      </div>

      <div class="flex flex-col gap-1 mt-5">
        <app-button
          [class]="{ current: section === 'buy' }"
          (trigger)="changeSection('buy')"
        >
          {{ "Buy" | translate }}
        </app-button>
        <app-button
          [class]="{ current: section === 'sell' }"
          (trigger)="changeSection('sell')"
        >
          {{ "Sell" | translate }}
        </app-button>
      </div>

      <div class="flex flex-col gap-1 mt-5 italic text-center">
        <p>Gils: {{ getGils() }}</p>
      </div>
    </div>

    <div class="col-span-4">
      <section *ngIf="section === 'buy'">
        <table style="width: 100%">
          <tr>
            <th>{{ "Name" | translate }}</th>
            <th>{{ "In stock" | translate }}</th>
            <th>{{ "Price" | translate }}</th>
            <th></th>
          </tr>

          <ng-container *ngIf="type === 'weapons'">
            <tr *ngFor="let weapon of shopWeapons">
              <td>
                <app-weapon-icon [type]="weapon.type"></app-weapon-icon>
                {{ weapon.ref }}<br />
                <span class="text-xs italic"
                  >({{ "Power" | translate }} {{ weapon.hits }})</span
                >
              </td>
              <td>{{ inStockWeapon(weapon) }}</td>
              <td>{{ weapon.price }} {{ "Gils" | translate }}</td>
              <td>
                <app-button
                  (trigger)="buyWeapon(weapon)"
                  [disabled]="!canBuyWeapon(weapon)"
                >
                  {{ "Buy" | translate }}
                </app-button>
              </td>
            </tr>
          </ng-container>

          <ng-container *ngIf="type === 'materias'">
            <tr *ngFor="let materia of shopMaterias" class="materia">
              <td>
                <app-materia-icon [color]="materia.color"></app-materia-icon>
                {{ "Mat. " + materia.name + " name" | translate }}<br />
                <span class="text-xs italic">{{
                  "Mat. " + materia.name + " desc" | translate
                }}</span>
              </td>
              <td *ngIf="materia.inStock(playerMaterias)">ðŸ—¸</td>
              <td *ngIf="!materia.inStock(playerMaterias)"></td>
              <td>{{ materia.price }} {{ "Gils" | translate }}</td>
              <td>
                <app-button
                  (trigger)="buyMateria(materia)"
                  [disabled]="!canBuyMateria(materia)"
                >
                  {{ "Buy" | translate }}
                </app-button>
              </td>
            </tr>
          </ng-container>

          <ng-container *ngIf="type === 'items'">
            <tr *ngFor="let item of shopItems" class="item">
              <td>
                <app-item-icon></app-item-icon>
                {{ "It. " + item.name + " name" | translate }}<br />
                <span class="text-xs italic">{{
                  "It. " + item.name + " desc" | translate
                }}</span>
              </td>
              <td>{{ inStockItem(item) }}</td>
              <td>{{ item.price }} {{ "Gils" | translate }}</td>
              <td>
                <app-button
                  (trigger)="buyItem(item)"
                  [disabled]="!canBuyItem(item)"
                >
                  {{ "Buy" | translate }}
                </app-button>
              </td>
            </tr>
          </ng-container>
        </table>
      </section>

      <section *ngIf="section === 'sell'">
        <table style="width: 100%">
          <tr>
            <th>{{ "Name" | translate }}</th>
            <th>{{ "In stock" | translate }}</th>
            <th>{{ "Price" | translate }}</th>
            <th></th>
          </tr>

          <ng-container *ngIf="type === 'weapons'">
            <tr *ngFor="let weapon of playerWeapons">
              <td>
                <app-weapon-icon [type]="weapon.type"></app-weapon-icon>
                {{ weapon.ref }}<br />
                <span class="text-xs italic"
                  >({{ "Power" | translate }} {{ weapon.hits }})</span
                >
              </td>
              <td>{{ inStockWeapon(weapon) }}</td>
              <td>{{ weapon.getSellPrice() }} {{ "Gils" | translate }}</td>
              <td>
                <app-button
                  (trigger)="sellWeapon(weapon)"
                  [disabled]="!canSellWeapon(weapon)"
                >
                  {{ "Sell" | translate }}
                </app-button>
              </td>
            </tr>
          </ng-container>

          <ng-container *ngIf="type === 'materias'">
            <tr *ngFor="let materia of playerMaterias" class="materia">
              <td>
                <app-materia-icon [color]="materia.color"></app-materia-icon>
                {{ "Mat. " + materia.name + " name" | translate }}<br />
                <span class="text-xs italic">{{
                  "Mat. " + materia.name + " desc" | translate
                }}</span>
              </td>
              <td *ngIf="materia.inStock">ðŸ—¸</td>
              <td *ngIf="!materia.inStock"></td>
              <td>{{ materia.getSellPrice() }} {{ "Gils" | translate }}</td>
              <td>
                <app-button (trigger)="sellMateria(materia)">
                  {{ "Sell" | translate }}
                </app-button>
              </td>
            </tr>
          </ng-container>

          <ng-container *ngIf="type === 'items'">
            <tr *ngFor="let item of playerItems" class="item">
              <td>
                <app-item-icon></app-item-icon>
                {{ "It. " + item.name + " name" | translate }}<br />
                <span class="text-xs italic">{{
                  "It. " + item.name + " desc" | translate
                }}</span>
              </td>
              <td>{{ inStockItem(item) }}</td>
              <td>{{ item.getSellPrice() }} {{ "Gils" | translate }}</td>
              <td>
                <app-button (trigger)="sellItem(item)">
                  {{ "Sell" | translate }}
                </app-button>
              </td>
            </tr>
          </ng-container>
        </table>
      </section>
    </div>
  </div>
</app-ui-layout-default>
