<div class="grid grid-cols-5 gap-x-4">

  <div>
    <div class="flex flex-col gap-1">
      <button class="button" (click)="fightRandom()" [class.disabled]="game.battle.isBattle" id="step6">
        {{"Fight random"|translate}}
      </button>
      <button class="button" (click)="fightBoss()" [class.disabled]="!game.battle.canFightBoss()">
        <div class="float-right text-red-700" *ngIf="game.battle.canFightBoss()">NEW</div>
        {{"Fight boss"|translate}}
      </button>
      <button class="button" (click)="attack()"
      [class]="{disabled: !game.battle.isBattle, limit: game.characters.canLimit()}" id="step7">
        <span *ngIf="!game.characters.canLimit()">{{"Attack"|translate}}</span>
        <span *ngIf="game.characters.canLimit()">{{"Limit"|translate}}</span>
      </button>
      <button class="button" (click)="escape()" [class.disabled]="!game.battle.isBattle" id="step8">
        {{"Escape"|translate}}
      </button>
    </div>

    <div class="flex flex-col gap-1 mt-5" id="step9">
      <button
        class="button flex flex-row items-center"
        *ngFor="let materia of game.materias.getEquipped()"
        (click)="materia.action()"
        [class.disabled]="!materia.canUse()">
        <img class="flex-none" src="/assets/images/icons/materias/{{materia.color}}.gif" />
        <div class="flex-grow">
          {{'Mat. '+materia.name+' name'|translate}}
        </div>
        <span class="flex-none">{{materia.getMpCost()}}</span>
      </button>
    </div>

    <div class="flex flex-col mt-5" *ngIf="game.items.getEquipped().length > 0" id="step10">
      <button
        class="button flex flex-row items-center"
        *ngFor="let item of game.items.getEquipped()"
        (click)="item.action()"
        [class.disabled]="!item.canUse()">
        <div class="flex-grow">{{'It. '+item.name+' name'|translate}}</div>
        <div class="flex-none">{{item.nbr}}</div>
    </button>
    </div>
  </div>

  <div class="col-span-2">
    <!-- characters bars -->
    <div class="float-right">
      <div class="hit hit_{{index+1}}" *ngFor="let hit of game.enemies.arrHits; let index = index">{{hit}}</div>
    </div>

    <app-bar
      [progress]="Math.round(game.characters.hp / game.characters.hpMax * 100)"
      [text]="game.characters.hp + ' / ' + game.characters.hpMax + 'HP'"
      [bgCurrent]="'bg-green-200'"
      [bgMax]="'bg-green-50'"
    ></app-bar>

    <app-bar
      [progress]="Math.round(game.characters.mp / game.characters.mpMax * 100)"
      [text]="game.characters.mp + ' / ' + game.characters.mpMax + 'MP'"
      [bgCurrent]="'bg-blue-200'"
      [bgMax]="'bg-blue-50'"
    ></app-bar>

    <app-bar
      [progress]="Math.round(game.characters.limit / game.characters.limitMax * 100)"
      [text]="'LIMIT'"
      [bgCurrent]="'bg-red-200'"
      [bgMax]="'bg-red-50'"
    ></app-bar>

      <!-- characters list -->
    <div id="step1">
      <div *ngFor="let character of game.characters.getTeam()" class="flex gap-4 mt-5">
        <div class="relative">
          <img src="{{character.image}}" alt="avatar" width="80" class="icon"/>
          <div class="absolute bg-black h-5 bottom-0 right-0 left-0 opacity-75 text-center">
            <span class="text-white text-sm">
              LVL{{character.level}}
            </span>
          </div>
        </div>

        <div class="flex-grow">
          <app-bar
            [progress]="Math.round(character.xp / character.getXpMax() * 100)"
            [text]="character.xp + ' / '+ character.getXpMax() + 'EXP'"
            [bgCurrent]="'bg-indigo-200'"
            [bgMax]="'bg-indigo-50'"
          ></app-bar>

          <div class="text-2xl">{{character.name}}</div>
          <!-- <div *ngIf="character.level > 0">
            <span class="">hp</span> {{character.getHpMax()}}
            <span class="">mp</span> {{character.getMpMax()}}
            <span class="">pwr</span> {{character.getHits()}}
          </div> -->
          <div class="text-sm italic">"{{character.getLine()|translate}}"</div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-span-2" id="step5">
    <!-- enemies bars -->
    <div *ngIf="game.enemies.list.length > 0">
      <div class="float-right">
        <div class="hit hit_{{index+1}}" *ngFor="let hit of game.characters.arrHits; let index = index">{{hit}}
        </div>
      </div>

      <app-bar
        [progress]="Math.round(game.enemies.hp / game.enemies.hpMax * 100)"
        [text]="game.enemies.hp + ' / ' + game.enemies.hpMax + 'HP'"
        [bgCurrent]="'bg-green-200'"
        [bgMax]="'bg-green-50'"
      ></app-bar>
    </div>

    <div *ngIf="game.enemies.list.length === 0" class="text-gray-300 uppercase text-center mt-10">
      {{"No enemies"|translate}}
    </div>

      <!-- enemies list -->
      <div *ngFor="let enemy of game.enemies.list" class="flex gap-4 mt-5">
        <div class="relative">
          <img [src]="enemy.image" alt="avatar" width="80" class="icon"/>
          <div class="absolute bg-black h-5 bottom-0 right-0 left-0 opacity-75 text-center">
            <span class="text-white text-sm">
              LVL{{enemy.level}}
            </span>
          </div>
        </div>

        <div class="flex-grow">

          <div class="text-2xl">{{enemy.name}}
            <span *ngIf="enemy.boss" class="boss">ZONE BOSS</span>
            <span *ngIf="enemy.miboss" class="boss">BOSS</span>
          </div>

          <!-- <div>
              <span class="label">hp</span> {{enemy.getHpMax()}}
              <span class="label">pwr</span> {{enemy.getHits()}}
          </div>
          <div>
              <span class="label">xp</span> {{enemy.xpReward()}}
              <span class="label">ap</span> {{enemy.apReward()}}
              <span class="label">gils</span> {{enemy.gilsReward()}}
          </div> -->
          <!-- <div *ngIf="enemy.weakness.length > 0">
              {{'Weakness'|translate}}
              <img *ngFor="let weakness of enemy.weakness" src="/assets/images/icons/elements/{{weakness}}.png" class="weakness" />
          </div>
          <div *ngIf="enemy.resistance.length > 0">
              {{'Resistance'|translate}}
              <img *ngFor="let resistance of enemy.resistance" src="/assets/images/icons/elements/{{resistance}}.png" class="resistance" />
          </div> -->
        </div>
      </div>
  </div>

</div>
